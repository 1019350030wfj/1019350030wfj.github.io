---
title: è®¾è®¡æ¨¡å¼ - è½¯ä»¶æ¶æ„çš„æ ¸å¿ƒåŸåˆ™ä¸å®è·µ
date: 2025-12-18
categories:
  - Architecture
  - æ¶æ„è®¾è®¡
tags:
  - è®¾è®¡æ¨¡å¼
  - SOLIDåŸåˆ™
  - è½¯ä»¶æ¶æ„
  - è®¾è®¡åŸåˆ™
  - å·¥ç¨‹åŒ–
---

## èƒŒæ™¯ & é—®é¢˜

åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é¢ä¸´è¿™æ ·çš„æŒ‘æˆ˜ï¼š
- **ä»£ç å¤ç”¨æ€§å·®**ï¼šç›¸ä¼¼åŠŸèƒ½é‡å¤å®ç°
- **å¯ç»´æŠ¤æ€§ä½**ï¼šä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½å½±å“å…¶ä»–æ¨¡å—
- **å¯æ‰©å±•æ€§ä¸è¶³**ï¼šæ–°åŠŸèƒ½éš¾ä»¥é›†æˆ
- **å¯æµ‹è¯•æ€§å·®**ï¼šå¤æ‚é€»è¾‘éš¾ä»¥å•å…ƒæµ‹è¯•

è®¾è®¡æ¨¡å¼æ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é€šç”¨é—®é¢˜çš„ç»è¿‡éªŒè¯çš„è§£å†³æ–¹æ¡ˆã€‚

## ç»“è®ºå…ˆè¡Œï¼ˆTL;DRï¼‰

è®¾è®¡æ¨¡å¼ä¸æ˜¯å…·ä½“çš„ä»£ç å®ç°ï¼Œè€Œæ˜¯è§£å†³é—®é¢˜çš„**æ€æƒ³æ¨¡æ¿**ã€‚æŒæ¡è®¾è®¡æ¨¡å¼èƒ½è®©ä½ ï¼š
- ğŸ¯ **å¿«é€Ÿè¯†åˆ«é—®é¢˜ç±»å‹**å¹¶åº”ç”¨æˆç†Ÿæ–¹æ¡ˆ
- ğŸ› ï¸ **ç¼–å†™å¯ç»´æŠ¤ä»£ç **ï¼Œé™ä½ç³»ç»Ÿå¤æ‚åº¦
- ğŸ“š **æå‡ç³»ç»Ÿå¯æ‰©å±•æ€§**ï¼Œè½»æ¾æ·»åŠ æ–°åŠŸèƒ½
- ğŸ§ª **æ”¹å–„å›¢é˜Ÿåä½œ**ï¼Œç»Ÿä¸€æŠ€æœ¯è¯­è¨€å’Œè®¾è®¡æ€è·¯

## åŸç†åˆ†æ

### è®¾è®¡æ¨¡å¼çš„æœ¬è´¨

è®¾è®¡æ¨¡å¼æ˜¯**åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­è§£å†³è½¯ä»¶è®¾è®¡é—®é¢˜çš„æ–¹æ¡ˆ**ï¼Œå®ƒåŒ…å«ï¼š
1. **é—®é¢˜ä¸Šä¸‹æ–‡** - ä½•æ—¶ä½¿ç”¨è¯¥æ¨¡å¼
2. **è§£å†³æ–¹æ¡ˆç»“æ„** - ç±»å’Œå¯¹è±¡çš„å…³ç³»
3. **åä½œå…³ç³»** - å¯¹è±¡å¦‚ä½•äº¤äº’
4. **å®ç°æ•ˆæœ** - ä½¿ç”¨è¯¥æ¨¡å¼çš„ä¼˜ç¼ºç‚¹

### GoF è®¾è®¡æ¨¡å¼åˆ†ç±»

#### 1. åˆ›å»ºå‹æ¨¡å¼ï¼ˆCreationalï¼‰
**ç›®çš„**ï¼šæ§åˆ¶å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ï¼Œéšè—åˆ›å»ºé€»è¾‘

| æ¨¡å¼ | è§£å†³é—®é¢˜ | åº”ç”¨åœºæ™¯ |
|--------|----------|----------|
| **å·¥å‚æ–¹æ³•** | å¯¹è±¡åˆ›å»ºçš„ç»Ÿä¸€æ¥å£ | æ ¹æ®å‚æ•°åˆ›å»ºä¸åŒäº§å“å¯¹è±¡ |
| **æŠ½è±¡å·¥å‚** | åˆ›å»ºå¯¹è±¡æ—çš„ç»Ÿä¸€æ¥å£ | æ”¯æŒäº§å“æ—çš„æ‰©å±• |
| **å•ä¾‹æ¨¡å¼** | ç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ | å…¨å±€é…ç½®ç®¡ç†å™¨ã€æ—¥å¿—å¯¹è±¡ |
| **å»ºé€ è€…æ¨¡å¼** | å¤æ‚å¯¹è±¡æ„å»ºçš„åˆ†æ­¥éª¤ | å‚æ•°åŒ–æ„å»ºã€éªŒè¯åˆ›å»º |

#### 2. ç»“æ„å‹æ¨¡å¼ï¼ˆStructuralï¼‰
**ç›®çš„**ï¼šå¦‚ä½•ç»„ç»‡ç±»å’Œå¯¹è±¡å½¢æˆæ›´å¤§çš„ç»“æ„

| æ¨¡å¼ | è§£å†³é—®é¢˜ | åº”ç”¨åœºæ™¯ |
|--------|----------|----------|
| **é€‚é…å™¨æ¨¡å¼** | æ¥å£ä¸å…¼å®¹çš„ç±»ä¹‹é—´çš„é€‚é… | æ–°æ—§ç³»ç»Ÿæ¥å£ç»Ÿä¸€ |
| **æ¡¥æ¥æ¨¡å¼** | å°†æ¥å£åˆ’åˆ†ä¸ºå¤šä¸ªå­æ¥å£ | é¿å…æ¥å£æ±¡æŸ“ |
| **ç»„åˆæ¨¡å¼** | å¯¹è±¡ç»„åˆæ ‘å½¢ç»“æ„ | ç»Ÿä¸€å¤„ç†å¶å­èŠ‚ç‚¹å¯¹è±¡ |
| **è£…é¥°å™¨æ¨¡å¼** | åŠ¨æ€æ·»åŠ å¯¹è±¡èŒè´£ | åŠŸèƒ½æ’ä»¶åŒ–ã€AOPåˆ‡é¢ |

#### 3. è¡Œä¸ºå‹æ¨¡å¼ï¼ˆBehavioralï¼‰
**ç›®çš„**ï¼šå¯¹è±¡é—´èŒè´£åˆ†é…å’Œé€šä¿¡

| æ¨¡å¼ | è§£å†³é—®é¢˜ | åº”ç”¨åœºæ™¯ |
|--------|----------|----------|
| **è§‚å¯Ÿè€…æ¨¡å¼** | å¯¹è±¡é—´æ¾è€¦åˆé€šä¿¡ | äº‹ä»¶ç›‘å¬ã€æ¶ˆæ¯é˜Ÿåˆ— |
| **å‘½ä»¤æ¨¡å¼** | å°†è¯·æ±‚å°è£…ä¸ºå¯¹è±¡ | å®å‘½ä»¤ã€æ’¤é”€æ“ä½œ |
| **çŠ¶æ€æ¨¡å¼** | å¯¹è±¡çŠ¶æ€å˜åŒ–çš„è¡Œä¸ºæ§åˆ¶ | å·¥ä½œæµå¼•æ“ã€æ¸¸æˆè§’è‰² |
| **ç­–ç•¥æ¨¡å¼** | ç®—æ³•æ—çš„å°è£…å’Œåˆ‡æ¢ | æ”¯ä»˜æ–¹å¼ã€æ’åºç®—æ³• |

#### 4. å…¶ä»–æ¨¡å¼
| æ¨¡å¼ | è§£å†³é—®é¢˜ | åº”ç”¨åœºæ™¯ |
|--------|----------|----------|
| **æ¨¡æ¿æ–¹æ³•** | æ“ä½œæ­¥éª¤æ¨¡æ¿ | æ•°æ®å¤„ç†æµç¨‹ |
| **è¿­ä»£å™¨æ¨¡å¼** | ç»Ÿä¸€è®¿é—®é›†åˆå¯¹è±¡ | å®¹å™¨éå†ã€æ•°æ®æµå¤„ç† |
| **ä»£ç†æ¨¡å¼** | å¯¹è±¡è®¿é—®çš„é—´æ¥æ§åˆ¶ | å»¶è¿ŸåŠ è½½ã€è®¿é—®æ§åˆ¶ |
| **äº«å…ƒæ¨¡å¼** | ç»†ç²’åº¦å¯¹è±¡å¤ç”¨ | å¯¹è±¡æ± ã€å†…å­˜ä¼˜åŒ– |

## å®ç°æ–¹æ¡ˆ

### 1. å·¥å‚æ¨¡å¼å®æˆ˜

#### é—®é¢˜åœºæ™¯
éœ€è¦æ”¯æŒå¤šç§æ•°æ®åº“è¿æ¥ï¼ˆMySQLã€PostgreSQLã€MongoDBï¼‰ï¼Œæ¯ç§æ•°æ®åº“æœ‰ä¸åŒçš„è¿æ¥å‚æ•°å’Œåˆå§‹åŒ–æ–¹å¼ã€‚

#### è§£å†³æ–¹æ¡ˆ

```java
// æŠ½è±¡å·¥å‚æ¥å£
public interface DatabaseConnectionFactory {
    Connection createConnection(String config);
    String getDatabaseType();
    boolean supportsTransaction();
}

// å…·ä½“å·¥å‚å®ç°
public class MySQLConnectionFactory implements DatabaseConnectionFactory {
    @Override
    public Connection createConnection(String config) {
        // MySQL è¿æ¥åˆ›å»ºé€»è¾‘
        return DriverManager.getConnection(config);
    }
    
    @Override
    public String getDatabaseType() {
        return "MySQL";
    }
    
    @Override
    public boolean supportsTransaction() {
        return true;
    }
}

// å·¥å‚ç®¡ç†å™¨
public class DatabaseFactory {
    private static Map<String, DatabaseConnectionFactory> factories = new HashMap<>();
    
    static {
        factories.put("mysql", new MySQLConnectionFactory());
        factories.put("postgresql", new PostgreSQLConnectionFactory());
        factories.put("mongodb", new MongoDBConnectionFactory());
    }
    
    public static Connection createConnection(String type, String config) {
        DatabaseConnectionFactory factory = factories.get(type.toLowerCase());
        if (factory != null) {
            return factory.createConnection(config);
        }
        throw new IllegalArgumentException("Unsupported database type: " + type);
    }
}

// å®¢æˆ·ç«¯ä½¿ç”¨
Connection conn = DatabaseFactory.createConnection("mysql", "jdbc:mysql://localhost:3306/mydb");
```

### 2. å•ä¾‹æ¨¡å¼å®æˆ˜

#### é—®é¢˜åœºæ™¯
å…¨å±€é…ç½®ç®¡ç†å™¨éœ€è¦åœ¨æ•´ä¸ªåº”ç”¨ä¸­ä¿æŒå”¯ä¸€å®ä¾‹ï¼Œé¿å…é…ç½®ä¸ä¸€è‡´ã€‚

#### è§£å†³æ–¹æ¡ˆ

```java
// æ‡’æ±‰å¼å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
public class ConfigurationManager {
    private static volatile ConfigurationManager instance;
    private static final Object lock = new Object();
    
    private Properties properties;
    
    private ConfigurationManager() {
        loadConfiguration();
    }
    
    public static ConfigurationManager getInstance() {
        if (instance == null) {
            synchronized (lock) {
                if (instance == null) {
                    instance = new ConfigurationManager();
                }
            }
        }
        return instance;
    }
    
    private void loadConfiguration() {
        // ä»é…ç½®æ–‡ä»¶åŠ è½½é…ç½®
        properties = new Properties();
        try (InputStream input = getClass().getResourceAsStream("/config.properties")) {
            properties.load(input);
        } catch (IOException e) {
            throw new RuntimeException("Failed to load configuration", e);
        }
    }
    
    public String getProperty(String key) {
        return properties.getProperty(key);
    }
    
    public String getProperty(String key, String defaultValue) {
        return properties.getProperty(key, defaultValue);
    }
}
```

### 3. è§‚å¯Ÿè€…æ¨¡å¼å®æˆ˜

#### é—®é¢˜åœºæ™¯
ç”¨æˆ·æ³¨å†Œç³»ç»Ÿéœ€è¦åœ¨ç”¨æˆ·çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥æ‰€æœ‰ç›¸å…³çš„ç›‘å¬å™¨ï¼ˆé‚®ä»¶é€šçŸ¥ã€æ—¥å¿—è®°å½•ç­‰ï¼‰ã€‚

#### è§£å†³æ–¹æ¡ˆ

```java
// è§‚å¯Ÿè€…æ¥å£
public interface UserObserver {
    void onUserRegistered(User user);
    void onUserStatusChanged(User user, String oldStatus, String newStatus);
    void onUserDeleted(User user);
}

// ä¸»é¢˜æ¥å£
public interface UserSubject {
    void registerObserver(UserObserver observer);
    void removeObserver(UserObserver observer);
    void notifyObservers(UserEventType eventType, User user);
}

// å…·ä½“ä¸»é¢˜å®ç°
public class UserService implements UserSubject {
    private List<UserObserver> observers = new ArrayList<>();
    private List<User> users = new ArrayList<>();
    
    @Override
    public void registerObserver(UserObserver observer) {
        if (!observers.contains(observer)) {
            observers.add(observer);
        }
    }
    
    @Override
    public void removeObserver(UserObserver observer) {
        observers.remove(observer);
    }
    
    @Override
    public void notifyObservers(UserEventType eventType, User user) {
        for (UserObserver observer : observers) {
            switch (eventType) {
                case USER_REGISTERED:
                    observer.onUserRegistered(user);
                    break;
                case STATUS_CHANGED:
                    observer.onUserStatusChanged(user, user.getOldStatus(), user.getStatus());
                    break;
                case USER_DELETED:
                    observer.onUserDeleted(user);
                    break;
            }
        }
    }
    
    public void changeUserStatus(User user, String newStatus) {
        String oldStatus = user.getStatus();
        user.setStatus(newStatus);
        notifyObservers(UserEventType.STATUS_CHANGED, user);
    }
}

// å…·ä½“è§‚å¯Ÿè€…å®ç°
public class EmailNotificationService implements UserObserver {
    @Override
    public void onUserRegistered(User user) {
        sendWelcomeEmail(user.getEmail());
    }
    
    @Override
    public void onUserStatusChanged(User user, String oldStatus, String newStatus) {
        sendStatusChangeEmail(user.getEmail(), oldStatus, newStatus);
    }
    
    @Override
    public void onUserDeleted(User user) {
        sendDeletionEmail(user.getEmail());
    }
    
    private void sendWelcomeEmail(String email) { /* å®ç° */ }
    private void sendStatusChangeEmail(String email, String oldStatus, String newStatus) { /* å®ç° */ }
    private void sendDeletionEmail(String email) { /* å®ç° */ }
}
```

## æ ¸å¿ƒä»£ç 

### Android å¼€å‘ä¸­çš„è®¾è®¡æ¨¡å¼åº”ç”¨

#### 1. Retrofit ä¸­çš„é€‚é…å™¨æ¨¡å¼
```java
// ä¸åŒç½‘ç»œè¯·æ±‚çš„é€‚é…å™¨
public interface Call<T> extends Cloneable {
    Response<T> execute() throws IOException;
}

public class SynchronousCallAdapter implements Call<Response<String>> {
    private final Call<Response<String>> delegateCall;
    
    public SynchronousCallAdapter(Call<Response<String>> delegateCall) {
        this.delegateCall = delegateCall;
    }
    
    @Override
    public Response<String> execute() throws IOException {
        try {
            Response<String> response = delegateCall.execute();
            // åŒæ­¥æ‰§è¡Œå¹¶å¤„ç†ç»“æœ
            return response;
        } catch (IOException e) {
            throw e;
        }
    }
    
    @Override
    public Call<Response<String>> clone() {
        return new SynchronousCallAdapter<>(delegateCall.clone());
    }
}
```

#### 2. EventBus ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼
```java
// EventBus ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼
public class EventBus {
    private final Map<Class<?>, List<Subscriber>> subscribers = new ConcurrentHashMap<>();
    
    public void register(Object subscriber) {
        register(subscriber.getClass(), subscriber);
    }
    
    public void register(Class<?> eventType, Object subscriber) {
        subscribers.computeIfAbsent(eventType, k -> new CopyOnWriteArrayList<>()).add(subscriber);
    }
    
    @SuppressWarnings("unchecked")
    public void post(Object event) {
        Class<?> eventType = event.getClass();
        List<Subscriber> eventSubscribers = subscribers.get(eventType);
        if (eventSubscribers != null) {
            for (Subscriber subscriber : eventSubscribers) {
                subscriber.handleEvent(event);
            }
        }
    }
}
```

## å¸¸è§å‘

### 1. è¿‡åº¦ä½¿ç”¨è®¾è®¡æ¨¡å¼
**å‘**ï¼šä¸ºäº†ç”¨è€Œç”¨ï¼Œåˆ°å¤„å¥—ç”¨è®¾è®¡æ¨¡å¼
**åæœ**ï¼šå¢åŠ ç³»ç»Ÿå¤æ‚åº¦ï¼Œé™ä½ä»£ç å¯è¯»æ€§
**è§£å†³**ï¼šåªåœ¨çœŸæ­£éœ€è¦æ—¶ä½¿ç”¨ï¼Œä¼˜å…ˆç®€å•çš„ç›´æ¥è§£å†³æ–¹æ¡ˆ

### 2. å¿½è§†è®¾è®¡åŸåˆ™
**å‘**ï¼šé€‰æ‹©è®¾è®¡æ¨¡å¼æ—¶ä¸è€ƒè™‘ SOLID åŸåˆ™
**åæœ**ï¼šä»£ç éš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•
**è§£å†³**ï¼šæ¯ä¸ªæ¨¡å¼é€‰æ‹©éƒ½è¦è¯„ä¼°å…¶ç¬¦åˆæ€§

### 3. æ¨¡å¼å®ç°é”™è¯¯
**å‘**ï¼šè®¾è®¡æ¨¡å¼çš„é”™è¯¯å®ç°å¯¼è‡´åæ¨¡å¼
**åæœ**ï¼šè¿èƒŒè®¾è®¡åˆè¡·ï¼Œå¢åŠ å¤æ‚åº¦
**è§£å†³**ï¼šæ·±å…¥ç†è§£æ¨¡å¼æ„å›¾ï¼Œç¡®ä¿å®ç°æ­£ç¡®æ€§

## å¯è¿ç§»ç»éªŒ

### 1. ä»å·¥å‚æ¨¡å¼åˆ°ä¾èµ–æ³¨å…¥
**ç»éªŒ**ï¼šåœ¨ç°ä»£æ¡†æ¶ä¸­ï¼Œä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆå¦‚ Daggerã€Springï¼‰èƒ½æ›´å¥½åœ°ç®¡ç†å¯¹è±¡åˆ›å»º
**è¿ç§»**ï¼šä½¿ç”¨æ¡†æ¶çš„ä¾èµ–æ³¨å…¥æ›¿ä»£æ‰‹åŠ¨å·¥å‚å®ç°

### 2. ä»è§‚å¯Ÿè€…æ¨¡å¼åˆ°å“åº”å¼ç¼–ç¨‹
**ç»éªŒ**ï¼šRxJavaã€Kotlin Flow ç­‰å“åº”å¼ç¼–ç¨‹èŒƒå¼æä¾›äº†æ›´å¼ºå¤§çš„äº‹ä»¶å¤„ç†èƒ½åŠ›
**è¿ç§»**ï¼šå°†äº‹ä»¶é©±åŠ¨çš„é€»è¾‘è¿ç§»åˆ°å“åº”å¼æµå¤„ç†

### 3. ä»å•ä¾‹æ¨¡å¼åˆ°å®¹å™¨ç®¡ç†
**ç»éªŒ**ï¼šåº”ç”¨å®¹å™¨çš„å•ä¾‹ç®¡ç†æ›´åŠ å®‰å…¨å’Œçµæ´»
**è¿ç§»**ï¼šä½¿ç”¨ @Singleton æ³¨è§£è®©å®¹å™¨ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ

### 4. è®¾è®¡æ¨¡å¼çš„ç»„åˆä½¿ç”¨
**ç»éªŒ**ï¼šå¤æ‚åœºæ™¯é€šå¸¸éœ€è¦å¤šç§æ¨¡å¼ååŒå·¥ä½œ
**å®è·µ**ï¼šå·¥å‚æ¨¡å¼ + ç­–ç•¥æ¨¡å¼å®ç°å¯é…ç½®çš„ç®—æ³•é€‰æ‹©å™¨

### 5. è®¾è®¡æ¨¡å¼çš„æ€§èƒ½è€ƒè™‘
**ç»éªŒ**ï¼šé€‰æ‹©è®¾è®¡æ¨¡å¼æ—¶éœ€è¦è€ƒè™‘æ€§èƒ½å½±å“
**ä¼˜åŒ–**ï¼šå¯¹è±¡æ± ã€ç¼“å­˜ã€å»¶è¿Ÿåˆå§‹åŒ–ç­‰æŠ€æœ¯æå‡æ€§èƒ½

## æ€»ç»“

è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹çš„é‡è¦å·¥å…·ï¼Œä½†ä¸æ˜¯é“¶å¼¹ï¼š

- âœ… **æ­£ç¡®ä½¿ç”¨**èƒ½æ˜¾è‘—æå‡ä»£ç è´¨é‡
- âœ… **è¿‡åº¦ä½¿ç”¨**åè€Œä¼šå¢åŠ å¤æ‚æ€§
- âœ… **ç»“åˆå®é™…**é€‰æ‹©æœ€é€‚åˆçš„è§£å†³æ–¹æ¡ˆ
- âœ… **æŒç»­å­¦ä¹ **æ·±å…¥ç†è§£æ¯ä¸ªæ¨¡å¼çš„é€‚ç”¨åœºæ™¯

æŒæ¡è®¾è®¡æ¨¡å¼ï¼Œè®©ä½ çš„ä»£ç æ›´ä¼˜é›…ã€æ›´çµæ´»ã€æ›´æ˜“äºç»´æŠ¤ã€‚è®°ä½ï¼š**æœ€å¥½çš„è®¾è®¡æ˜¯é‚£äº›ä½ ä¸éœ€è¦çš„è®¾è®¡**ã€‚
